<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Bitmovin V7 Player (DASH / HLS / MP4)</title>
    <link rel="stylesheet" href="./css/styles.css">
    <script src="js/realtime.js" type="text/javascript"></script>
    <script src="//code.highcharts.com/highcharts.js"></script>
    <!-- Bitmovin Player -->
    <script type="text/javascript"
            src="//bitmovin-a.akamaihd.net/bitmovin-player/stable/7.6/bitmovinplayer.js"></script>
    <!-- Bitmovin Analytics -->
    <script type="text/javascript"
            src="//bitmovin-a.akamaihd.net/bitmovin-analytics/stable/1.5.3/bitmovinanalytics.min.js"></script>

</head>
<body>
<div id="wrapper">
    <div id="banner">
        <div class="logo"><img src="images/bitmovin-logo.png"></div>
        <div class="title"><h1>Bitmovin HTML5 Player</h1></div>
        <div class="clear"></div>
    </div>

    <div class="container">
        <h2>Multi-Codec Support H.264/HEVC/VP9</h2>
        <div class="content">
            <div class="player-wrapper">
                <!-- dynamic text by js -->
                <div class="title1">
                    <h4>H.264/AVC</h4>
                    <div id="player1"></div>
                    <div class="description">
                        <p>Video Statistics</p>
                        <button onclick="toggle('video-information-table-wrapper')">Toggle</button>
                    </div>
                    <div id="video-information-table-wrapper" class="player-grid wrapper-closed">
                        <table id="video-information-table">
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="description">
                        <p>Client Information</p>
                        <button onclick="toggle('information-wrapper')">Toggle</button>
                    </div>
                    <div id="information-wrapper" class="player-grid">
                        <div class="information">
                            <table id="information-table">
                                <tbody>

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="description">
                        <p>Adaptation Behaviour Graph</p>
                        <button onclick="toggle('adaptation-behaviour-wrapper')">Toggle</button>
                    </div>
                    <div id="adaptation-behaviour-wrapper" class="player-grid" style="margin-top: 30px">
                        <div id="adaptation-behaviour"></div>
                    </div>
                    <div class="description">
                        <p>Impression Log</p>
                        <button onclick="toggle('impression-log-wrapper')">Toggle</button>
                    </div>
                    <div id="impression-log-wrapper" class="player-grid wrapper-closed" style="margin-top: 30px">
                        <div id="impression-log">
                            <table id="impression-log-table">
                                <thead>
                                <tr>
                                    <th>State</th>
                                    <th>Player Startuptime</th>
                                    <th>Video Startuptime</th>
                                    <th>Duration</th>
                                    <th>Buffered</th>
                                    <th>Video Time Start</th>
                                    <th>Video Time End</th>
                                    <th>Played</th>
                                    <th>Paused</th>
                                    <th>Seeked</th>
                                    <th>Video Bitrate</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="description">
                        <p>Query responses from Bitmovin API</p>
                        <button onclick="toggle('backend-calls-wrapper')">Toggle</button>
                    </div>
                    <div id="backend-calls-wrapper" class="player-grid wrapper-closed" style="margin-top: 30px">
                        <div id="backend-calls">
                            <table id="backend-calls-table">
                                <tbody style="display: block">
                                <tr></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <div class="title1">
                    <h4>VP9</h4>
                    <div id="player2"></div>
                    <div class="description">
                        <p>Video Statistics</p>
                        <button onclick="toggle('video-information-table-wrapper-2')">Toggle</button>
                    </div>
                    <div id="video-information-table-wrapper-2" class="player-grid wrapper-closed">
                        <table id="video-information-table-2">
                            <tbody>
                            </tbody>
                        </table>
                    </div>
                    <div class="description">
                        <p>Client Information</p>
                        <button onclick="toggle('information-wrapper-2')">Toggle</button>
                    </div>
                    <div id="information-wrapper-2" class="player-grid">
                        <div class="information">
                            <table id="information-table-2">
                                <tbody>

                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="description">
                        <p>Adaptation Behaviour Graph</p>
                        <button onclick="toggle('adaptation-behaviour-wrapper-2')">Toggle</button>
                    </div>
                    <div id="adaptation-behaviour-wrapper-2" class="player-grid" style="margin-top: 30px">
                        <div id="adaptation-behaviour-2"></div>
                    </div>
                    <div class="description">
                        <p>Impression Log</p>
                        <button onclick="toggle('impression-log-wrapper-2')">Toggle</button>
                    </div>
                    <div id="impression-log-wrapper-2" class="player-grid wrapper-closed" style="margin-top: 30px">
                        <div id="impression-log-2">
                            <table id="impression-log-table-2">
                                <thead>
                                <tr>
                                    <th>State</th>
                                    <th>Player Startuptime</th>
                                    <th>Video Startuptime</th>
                                    <th>Duration</th>
                                    <th>Buffered</th>
                                    <th>Video Time Start</th>
                                    <th>Video Time End</th>
                                    <th>Played</th>
                                    <th>Paused</th>
                                    <th>Seeked</th>
                                    <th>Video Bitrate</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="description">
                        <p>Query responses from Bitmovin API</p>
                        <button onclick="toggle('backend-calls-wrapper-2')">Toggle</button>
                    </div>
                    <div id="backend-calls-wrapper-2" class="player-grid wrapper-closed" style="margin-top: 30px">
                        <div id="backend-calls-2">
                            <table id="backend-calls-table-2">
                                <tbody style="display: block">
                                <tr></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    // BITMOVING KEY(S)
    const BITMOVIN_PLAYER_KEY = '3d1aeff2-cc32-4eb4-b4e8-0699af6823de';
    const BITMOVIN_ANALYTICS_KEY = '58add32c-46b7-4a18-8b73-71613c0c33be';
    var t = new Date().getTime();

    // Browser detection
    // Chrome 1+
    var isChrome = !!window.chrome && !!window.chrome.webstore;
    // Firefox 1.0+
    var isFirefox = typeof InstallTrigger !== 'undefined';
    // Safari
    var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) {
        return p.toString() === "[object SafariRemoteNotification]";
    })(!window['safari'] || (typeof safari !== 'undefined' && safari.pushNotification));

    var vp9 = 'http://bitmovin-a.akamaihd.net/content/multi-codec/vp9/stream.mpd';
    var hvec = 'http://bitmovin-a.akamaihd.net/content/dataset/multi-codec/hevc/stream.mpd';
    var defaultDash = 'http://bitdash-a.akamaihd.net/content/MI201109210084_1/mpds/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.mpd';


    var Realtime = function () {
        var analyticsConfig = {
            key: BITMOVIN_ANALYTICS_KEY,
            playerKey: BITMOVIN_PLAYER_KEY,
            player: bitmovin.analytics.Players.BITMOVIN,
            cdnProvider: bitmovin.analytics.CdnProviders.AKAMAI,
            videoId: 'CODEC-DEMO-' + t,
            customData1: 'CODEC-SESSION' + t,
            userId: 'CODEC-USER1'
        };

        var playerConfig = {
            key: BITMOVIN_PLAYER_KEY,
            playback: {
                muted: true
            },
            source: {
                dash: 'https://bitmovin-a.akamaihd.net/content/multi-codec/h264/stream.mpd',
                hls: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',
                progressive: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/MI201109210084_mpeg-4_hd_high_1080p25_10mbits.mp4',
            },
            style: {
                width: '100%',
                aspectratio: '16:9'
            },
            events: {
                onReady: handleOnReady,
                onPlay: handleOnPlay,
                onPlaybackFinished: function () {
                    window.clearTimeout(onPlayTimeout);
                    window.clearInterval(impressionPollingInterval);

                }
            }
        };

        this.start = function () {
            analytics = bitmovin.analytics(analyticsConfig);
            player = bitmovin.player('player1');

            analytics.register(player);
            player.setup(playerConfig);

            initCurrentImpressionChart('adaptation-behaviour');
            getVideoStatistics(analyticsConfig.videoId, 'video-information-table');
        };
    };

    var condecSource;
     if (isChrome) {
         condecSource = vp9;
     } else if (isFirefox) {
         condecSource = vp9;
     } else if (isSafari) {
         condecSource = hvec;
         document.getElementsByTagName("h4")[1].innerHTML = "H.265/HVEC";
     } else {
         condecSource = defaultDash;
     }

    var Realtime2 = function () {
        var analyticsConfig = {
            key: BITMOVIN_ANALYTICS_KEY,
            playerKey: BITMOVIN_PLAYER_KEY,
            player: bitmovin.analytics.Players.BITMOVIN,
            cdnProvider: bitmovin.analytics.CdnProviders.AKAMAI,
            videoId: 'CODEC-DEMO-' + t,
            customData1: 'CODEC-SESSION' + t,
            userId: 'CODEC-USER1'
        };

        var playerConfig = {
            key: BITMOVIN_PLAYER_KEY,
            playback: {
                muted: true
            },
            source: {
                dash: condecSource,
                hls: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',
                progressive: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/MI201109210084_mpeg-4_hd_high_1080p25_10mbits.mp4',
            },
            style: {
                width: '100%',
                aspectratio: '16:9'
            },
            events: {
                onReady: handleOnReady,
                onPlay: handleOnPlay,
                onPlaybackFinished: function () {
                    window.clearTimeout(onPlayTimeout);
                    window.clearInterval(impressionPollingInterval);

                }
            }
        };

        this.start = function () {
            analytics = bitmovin.analytics(analyticsConfig);
            player = bitmovin.player('player2');

            analytics.register(player);
            player.setup(playerConfig);

            initCurrentImpressionChart('adaptation-behaviour-2');
            getVideoStatistics(analyticsConfig.videoId, 'video-information-table-2');
        };
    };


    // PLAYERS 1,2
    //
    //  var player = bitmovin.player("player1");
    //  var conf = {
    //      key: BITMOVIN_PLAYER_KEY,
    //      playback: {
    //          autoplay: true,
    //          muted: true
    //      },
    //      source: {
    //                dash: 'https://bitmovin-a.akamaihd.net/content/multi-codec/h264/stream.mpd',
    //                hls: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',
    //                progressive: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/MI201109210084_mpeg-4_hd_high_1080p25_10mbits.mp4',
    //
    //      },
    //  };
    //
    // player.setup(conf).then(function (value) {
    //     console.log("Successfully created bitmovin player1 instance");
    // }, function (reason) {
    //     console.log("Error while creating bitmovin player1 instance");
    // });
    //
    //  var player = bitmovin.player("player2");
    //  var vp9 = 'http://bitmovin-a.akamaihd.net/content/multi-codec/vp9/stream.mpd';
    //  var hvec = 'http://bitmovin-a.akamaihd.net/content/dataset/multi-codec/hevc/stream.mpd';
    //  var defaultDash = 'http://bitdash-a.akamaihd.net/content/MI201109210084_1/mpds/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.mpd';
    //
    //  if (isChrome) {
    //      condecSource = vp9;
    //  } else if (isFirefox) {
    //      condecSource = vp9;
    //  } else if (isSafari) {
    //      condecSource = hvec;
    //      document.getElementsByTagName("h4")[1].innerHTML = "H.265/HVEC";
    //  } else {
    //      condecSource = defaultDash;
    //  }
    //
    //  var conf = {
    //     key: BITMOVIN_PLAYER_KEY,
    //     playback: {
    //          autoplay: true,
    //          muted: true
    //      },
    //     source: {
    //               dash: condecSource,
    //               hls: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/m3u8s/f08e80da-bf1d-4e3d-8899-f0f6155f6efa.m3u8',
    //               progressive: 'https://bitdash-a.akamaihd.net/content/MI201109210084_1/MI201109210084_mpeg-4_hd_high_1080p25_10mbits.mp4',
    //
    //     }
    //  };
    //
    //  player.setup(conf).then(function (value) {
    //      console.log("Successfully created bitmovin player2 instance");
    //  }, function (reason) {
    //      console.log("Error while creating bitmovin player2 instance");
    //  });
</script>

<script type="text/javascript">
    (function () {
        if (location.protocol === "file:") {
            document.getElementById("webserver-warning").style.display = "block";
            return;
        }

        var realtime = new Realtime();
        realtime.start();

        var realtime2 = new Realtime2();
        realtime2.start();
    })();
</script>

<script type="text/javascript">
    function toggle(divToToggleId) {
        var div = document.getElementById(divToToggleId);
        div.style.display = div.style.display == "none" ? "block" : "none";
    }

    (function closeDivs(divs) {
        for (var i = 0; i < divs.length; i++) {
            divs[i].style.display = "none";
        }
    })(document.getElementsByClassName("wrapper-closed"))
</script>
</body>
</html>